# generated {{ ansible_date_time.iso8601 }}

# ───────── General ───────────────────────────────────────────────
TIMEZONE={{ stack_timezone }}
MEM_LIMIT={{ mem_limit }}

# ───────── Traefik / TLS ─────────────────────────────────────────
TRAEFIK_DOMAIN={{ stack_domain }}
TRAEFIK_LE_EMAIL={{ stack_email }}
TRAEFIK_BASIC_AUTH={{ basic_auth | quote }}
TRAEFIK_VERSION={{ traefik_version | default('v3.4.1') }}
CLOUDFLARE_DNS_API_TOKEN={{ cloudflare_api_token }}

# ───────── Observability  ───────────────────────────────
PROMETHEUS_VERSION={{ prometheus_version | default('v3.3.1') }}
LOKI_VERSION={{ loki_version | default('3.0.0') }}
GRAFANA_VERSION={{ grafana_version | default('10.4.3') }}
GRAFANA_ADMIN_USER={{ grafana_admin_user | default('admin') }}
GRAFANA_ADMIN_PASSWORD={{ grafana_admin_password | default('admin') }}
NODE_EXPORTER_VERSION={{ node_exporter_version | default('v1.9.1') }}
PORTAINER_VERSION={{ portainer_version | default('2.20.3') }}
PORTAINER_PORT={{ portainer_port | default('9000') }}
GF_ANALYTICS_REPORTING_ENABLED=false
GF_ANALYTICS_CHECK_FOR_UPDATES=false


# ───────── n8n──────────────────────────────────────────
N8N_VERSION={{ n8n_version | default('1.50.0') }}
WEBHOOK_URL={{ webhook_url | default('https://n8n.' ~ stack_domain ~ '/') }}
N8N_HOST={{ n8n_host | default('n8n.' ~ stack_domain) }}
N8N_PROTOCOL={{ n8n_protocol | default('https') }}
N8N_EDITOR_BASE_URL={{ n8n_editor_base_url | default('https://n8n.' ~ stack_domain ~ '/') }}
N8N_BASIC_AUTH_ACTIVE={{ n8n_basic_auth_active | default(false) | lower }}
N8N_USER_MANAGEMENT_DISABLED={{ n8n_user_management_disabled | default(true) | lower }}
N8N_ADMIN_EMAIL={{ n8n_admin_email }}
N8N_EMAIL_MODE=smtp
N8N_SMTP_HOST={{ smtp_host }}
N8N_SMTP_PORT={{ smtp_port }}
N8N_SMTP_SSL={{ smtp_ssl | lower }}
N8N_SMTP_SENDER="n8n <{{ n8n_admin_email }}>"
N8N_ADMIN_PASSWORD={{ n8n_admin_password }}
N8N_PERSONALIZATION_ENABLED={{ n8n_personalization_enabled | default(false) | lower }}
N8N_DIAGNOSTICS_ENABLED={{ n8n_diagnostics_enabled | default(false) | lower }}
N8N_VERSION_NOTIFICATIONS_ENABLED={{ n8n_version_notifications_enabled | default(false) | lower }}
N8N_TEMPLATES_ENABLED={{ n8n_templates_enabled | default(false) | lower }}


# ───────── ollama ──────────────────────────────────────────

OLLAMA_VERSION={{ ollama_version | default('0.10.0') }}
OLLAMA_PULL_MODELS={{ ollama_pull_models | default('llama3.1:8b deepseek-r1:7b qwen2.5-coder:7b bge-m3') }}
OLLAMA_MMAP={{ ollama_mmap | default(true) | lower }}
OLLAMA_MAX_REPLICAS={{ ollama_max_replicas | default(4) }}
OLLAMA_IDLE_TIMEOUT={{ ollama_idle_timeout | default('120s') }}
OLLAMA_NUM_PARALLEL={{ ollama_num_parallel | default(8) }}
OLLAMA_CONTEXT_SIZE={{ ollama_context_size | default(4096) }}
OLLAMA_KEEP_ALIVE={{ ollama_keep_alive | default('5m') }}
OLLAMA_MAX_LOADED_MODELS={{ ollama_max_loaded_models | default(3) }}
OLLAMA_MAX_QUEUE={{ ollama_max_queue | default(512) }}
OLLAMA_KV_CACHE_TYPE={{ ollama_kv_cache_type | default('') }}

# Optional ROCm tuning (only used with compose.rocm.yaml)
OLLAMA_ROCM_ENABLED={{ (ollama_use_rocm_overlay | bool) | ternary('true', 'false') }}
OLLAMA_ROCM_DEVICE_KFD={{ ollama_rocm_device_kfd | default('/dev/kfd') }}
OLLAMA_ROCM_DEVICE_DRI={{ ollama_rocm_device_dri | default('/dev/dri') }}
OLLAMA_ROCM_SECCOMP={{ ollama_rocm_seccomp | default('unconfined') }}
OLLAMA_ROCM_HSA_OVERRIDE_GFX_VERSION={{ ollama_rocm_hsa_override_gfx_version | default('') }}
OLLAMA_ROCM_HSA_ENABLE_SDMA={{ ollama_rocm_hsa_enable_sdma | default('0') }}
OLLAMA_ROCM_HSA_NO_SCRATCH_RECLAIM={{ ollama_rocm_hsa_no_scratch_reclaim | default('1') }}
OLLAMA_ROCM_ROCR_VISIBLE_DEVICES={{ ollama_rocm_rocr_visible_devices | default('0') }}
OLLAMA_ROCM_HIP_VISIBLE_DEVICES={{ ollama_rocm_hip_visible_devices | default('0') }}
OLLAMA_ROCM_HSA_VISIBLE_DEVICES={{ ollama_rocm_hsa_visible_devices | default('0') }}

# Optional ROCm tuning (only used with compose.rocm.yaml)
OLLAMA_ROCM_ENABLED={{ (ollama_use_rocm_overlay | bool) | ternary('true', 'false') }}
OLLAMA_ROCM_DEVICE_KFD={{ ollama_rocm_device_kfd | default('/dev/kfd') }}
OLLAMA_ROCM_DEVICE_DRI={{ ollama_rocm_device_dri | default('/dev/dri') }}
OLLAMA_ROCM_SECCOMP={{ ollama_rocm_seccomp | default('unconfined') }}
OLLAMA_ROCM_HSA_OVERRIDE_GFX_VERSION={{ ollama_rocm_hsa_override_gfx_version | default('') }}

# ───────── openwebui ──────────────────────────────────────────
OPENWEBUI_VERSION={{ openwebui_version | default('v0.6.22') }}
OPENWEBUI_PORT={{ openwebui_port | default('8080') }}
OPENWEBUI_ADMIN_EMAIL={{ openwebui_admin_email | default('admin@example.com') }}
OPENWEBUI_ADMIN_PASSWORD={{ openwebui_admin_password | default('changeme') }}
OPENWEBUI_ENABLE_SIGNUP={{ openwebui_enable_signup | default(false) | lower }}
OPENWEBUI_DEFAULT_USER_ROLE={{ openwebui_default_user_role | default('pending') }}
OPENWEBUI_ENABLE_PERSISTENT_CONFIG={{ openwebui_enable_persistent_config | default(true) | lower }}
# --- Open WebUI runtime / privacy / endpoints ---
WEBUI_URL={{ webui_url | default('https://chat.' ~ stack_domain) }}
OFFLINE_MODE={{ openwebui_offline_mode | lower }}
ENABLE_VERSION_UPDATE_CHECK={{ openwebui_enable_version_update_check | lower }}
OLLAMA_BASE_URL={{ ollama_base_url }}

# --- Web search wiring (SearXNG by default, private / internal) ---
ENABLE_WEB_SEARCH={{ openwebui_enable_web_search | lower }}
WEB_SEARCH_ENGINE={{ openwebui_web_search_engine }}
ENABLE_SEARCH_QUERY_GENERATION={{ openwebui_enable_search_query_generation | lower }}
WEB_SEARCH_RESULT_COUNT={{ openwebui_web_search_result_count }}
WEB_SEARCH_CONCURRENT_REQUESTS={{ openwebui_web_search_concurrent_requests }}
SEARXNG_QUERY_URL={{ searxng_query_url }}
DEFAULT_MODELS={{ openwebui_default_models | default('llama3.1:8b') }}
DEFAULT_PROMPT_SUGGESTIONS={{ openwebui_default_prompt_suggestions | to_json }}

# ───────── Elasticsearch  ───────────────────
ES_VERSION={{ es_version | default('8.13.4') }}
ES_PORT={{ es_port }}
ES_PASSWORD={{ es_password }}
ES_HOST={{ es_host }}


# ------------- Infinity ----------------------------------
INFINITY_VERSION={{ infinity_version | default('v0.6.0-dev3') }}
INFINITY_THRIFT_PORT={{ infinity_thrift_port }}
INFINITY_HTTP_PORT={{ infinity_http_port }}
INFINITY_PSQL_PORT={{ infinity_psql_port }}
INFINITY_HOST={{ infinity_host }}

# ───────── MySQL ────────────────────────────────────────────────
MYSQL_VERSION={{ mysql_version | default('8.0.39') }}
MYSQL_ROOT_PASSWORD={{ mysql_root_password }}
MYSQL_PORT={{ mysql_port }}
MYSQL_HOST={{ mysql_host }}
MYSQL_DATABASE={{ mysql_dbname }}
MYSQL_ROOT_HOST=%

# ───────── MinIO ────────────────────────────────────────────────
MINIO_VERSION={{ minio_version | default('RELEASE.2025-04-22T22-12-26Z') }}
MINIO_PORT={{ minio_port | default('9000')}}
MINIO_CONSOLE_PORT={{ minio_console_port | default('9001') }}
MINIO_ROOT_USER={{ minio_root_user }}
MINIO_ROOT_PASSWORD={{ minio_root_password }}

# ───────── Valkey (Redis‑compatible) ────────────────────────────
REDIS_VERSION={{ redis_version | default('8.1.0') }}
REDIS_PASSWORD={{ redis_password }}
REDIS_PORT={{ redis_port }}
REDIS_HOST={{ redis_host }}


# ───────── Stirling PDF ─────────────────────────────────────────────
STIRLING_PDF_VERSION={{ stirling_pdf_version | default('latest') }}
STIRLING_PDF_PORT={{ stirling_pdf_port | default('8080') }}
STIRLING_PDF_ENABLE_LOGIN={{ stirling_pdf_enable_login | default(false) | lower }}


# ───────── Ragflow ─────────────────────────────────────────────────
SVR_HTTP_PORT={{ svr_http_port }}


HF_ENDPOINT={{ hf_endpoint }}
MACOS={{ macos | lower }}

DOC_ENGINE={{ ragflow_doc_engine }}
RAGFLOW_VERSION={{ ragflow_version | default('v0.18.0' )}}
RAGFLOW_EXTRA_PORTS={{ ragflow_extra_ports }}
RAGFLOW_NGINX_CONF_DIR={{ ragflow_nginx_conf_dir }}
RAGFLOW_HISTORY_DIR={{ ragflow_history_dir }}
RAGFLOW_LOG_DIR={{ ragflow_log_dir }}

# A user registration switch:
# - Enable registration: 1
# - Disable registration: 0
REGISTER_ENABLED={{ register_enabled }}
# Admin bootstrap credentials
RAGFLOW_ADMIN_EMAIL={{ ragflow_admin_email }}
RAGFLOW_ADMIN_PASSWORD={{ ragflow_admin_password }}

# ───────── No-Code Architects Toolkit ─────────────────────────────
NCA_VERSION={{ nca_toolkit_version | default('latest') }}
NCA_API_KEY={{ nca_api_key | default('replace_me') }}
NCA_S3_ENDPOINT={{ nca_s3_endpoint }}
NCA_S3_BUCKET={{ nca_s3_bucket | default('pocket-lab') }}
NCA_S3_ACCESS_KEY={{ nca_s3_access_key }}
NCA_S3_SECRET_KEY={{ nca_s3_secret_key }}

# ───────── Tailscale ────────────────────────────────────────────────
TS_AUTHKEY={{ ts_authkey | default('') }}
TS_HOSTNAME= {{ ts_hostname | default('') }}
DOCKER_BRIDGE_SUBNET={{ docker_bridge_subnet | default('172.20.0.0/16') }}

# ───────── smtp relay ─────────────────────────────────────────────────
SMTP_IMAGE={{ smtp_image | default('boky/postfix:latest') }}
SMTP_HOST={{ smtp_host | default('smtp') }}
SMTP_PORT={{ smtp_port | default(25) }}
SMTP_SSL={{ smtp_ssl | default(false) | lower }}
