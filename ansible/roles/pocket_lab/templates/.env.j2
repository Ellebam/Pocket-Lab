# generated {{ ansible_date_time.iso8601 }}

# ───────── General ───────────────────────────────────────────────
TIMEZONE={{ stack_timezone }}
MEM_LIMIT={{ mem_limit }}

# ───────── Traefik / TLS ─────────────────────────────────────────
TRAEFIK_DOMAIN={{ stack_domain }}          # apex domain (e.g. ai.lab.example.com)
TRAEFIK_LE_EMAIL={{ stack_email }}         # ACME registration mail
TRAEFIK_BASIC_AUTH={{ basic_auth | quote }}        # htpasswd‑style user:hash
TRAEFIK_VERSION={{ traefik_version | default('v3.4.1') }}
CLOUDFLARE_DNS_API_TOKEN={{ cloudflare_api_token }}

# ───────── Observability  ───────────────────────────────
PROMETHEUS_VERSION={{ prometheus_version | default('v3.3.1') }}
LOKI_VERSION={{ loki_version | default('3.0.0') }}
GRAFANA_VERSION={{ grafana_version | default('10.4.3') }}
GRAFANA_ADMIN_USER={{ grafana_admin_user | default('admin') }}
GRAFANA_ADMIN_PASSWORD={{ grafana_admin_password | default('admin') }}
NODE_EXPORTER_VERSION={{ node_exporter_version | default('v1.9.1') }}
PORTAINER_VERSION={{ portainer_version | default('2.20.3') }}
PORTAINER_PORT={{ portainer_port | default('9443') }}


# ───────── n8n──────────────────────────────────────────
N8N_VERSION={{ n8n_version | default('1.50.0') }}
N8N_BASIC_AUTH_ACTIVE={{ n8n_basic_auth_active | default(false) | lower }}
N8N_USER_MANAGEMENT_DISABLED={{ n8n_user_management_disabled | default(false) | lower }}
N8N_ADMIN_EMAIL={{ n8n_admin_email }}
N8N_EMAIL_MODE=smtp
N8N_SMTP_HOST={{ smtp_host }}
N8N_SMTP_PORT={{ smtp_port }}
N8N_SMTP_SSL={{ smtp_ssl | lower }}
N8N_SMTP_SENDER="n8n <{{ n8n_admin_email }}>"
N8N_ADMIN_PASSWORD={{ n8n_admin_password }}
N8N_PERSONALIZATION_ENABLED={{ n8n_personalization_enabled | default(false) | lower }}


# ───────── ollama ──────────────────────────────────────────

OLLAMA_VERSION={{ ollama_version | default('0.10.0') }}
OLLAMA_PULL_MODELS={{ ollama_pull_models | default('llama3.2 bge-m3 mistral:7b-instruct-q4_K_M') }}
OLLAMA_MAX_REPLICAS={{ ollama_max_replicas | default(4) }}
OLLAMA_IDLE_TIMEOUT={{ ollama_idle_timeout | default('120s') }}
OLLAMA_NUM_PARALLEL={{ ollama_num_parallel | default(8) }}
OLLAMA_CONTENT_SIZE={{ ollama_content_size | default(4096) }}

# ───────── openwebui ──────────────────────────────────────────
OPENWEBUI_VERSION={{ openwebui_version | default('v0.6.9') }}
OPENWEBUI_PORT={{ openwebui_port | default('8080') }}
OPENWEBUI_ADMIN_EMAIL={{ openwebui_admin_email | default('admin@example.com') }}
OPENWEBUI_ADMIN_PASSWORD={{ openwebui_admin_password | default('changeme') }}
OPENWEBUI_ENABLE_SIGNUP={{ openwebui_enable_signup | default(false) | lower }}
OPENWEBUI_DEFAULT_USER_ROLE={{ openwebui_default_user_role | default('pending') }}
OPENWEBUI_ENABLE_PERSISTENT_CONFIG={{ openwebui_enable_persistent_config | default(true) | lower }}

# ───────── Elasticsearch  ───────────────────
ES_VERSION={{ es_version | default('8.13.4') }}
ES_PORT={{ es_port }}
ES_PASSWORD={{ es_password }}
ES_HOST={{ es_host }}


# ------------- Infinity ----------------------------------
INFINITY_VERSION={{ infinity_version | default('v0.6.0-dev3') }}
INFINITY_THRIFT_PORT={{ infinity_thrift_port }}
INFINITY_HTTP_PORT={{ infinity_http_port }}
INFINITY_PSQL_PORT={{ infinity_psql_port }}
INFINITY_HOST={{ infinity_host }}

# ───────── MySQL ────────────────────────────────────────────────
MYSQL_VERSION={{ mysql_version | default('8.0.39') }}
MYSQL_ROOT_PASSWORD={{ mysql_root_password }}
MYSQL_PORT={{ mysql_port }}
MYSQL_HOST={{ mysql_host }}
MYSQL_DATABASE={{ mysql_dbname }}
MYSQL_ROOT_HOST=%

# ───────── MinIO ────────────────────────────────────────────────
MINIO_VERSION={{ minio_version | default('RELEASE.2023-12-20T01-00-02Z') }}
MINIO_PORT={{ minio_port | default('9000')}}
MINIO_CONSOLE_PORT={{ minio_console_port | default('9001') }}
MINIO_ROOT_USER={{ minio_root_user }}
MINIO_ROOT_PASSWORD={{ minio_root_password }}

# ───────── Valkey (Redis‑compatible) ────────────────────────────
REDIS_VERSION={{ redis_version | default('8.1.0') }}
REDIS_PASSWORD={{ redis_password }}
REDIS_PORT={{ redis_port }}
REDIS_HOST={{ redis_host }}


# ───────── Ragflow ─────────────────────────────────────────────────
SVR_HTTP_PORT={{ svr_http_port }}


HF_ENDPOINT={{ hf_endpoint }}
MACOS={{ macos | lower }}

DOC_ENGINE={{ ragflow_doc_engine }}
RAGFLOW_VERSION={{ ragflow_version | default('v0.18.0' )}}
RAGFLOW_EXTRA_PORTS={{ ragflow_extra_ports }}
RAGFLOW_NGINX_CONF_DIR={{ ragflow_nginx_conf_dir }}
RAGFLOW_HISTORY_DIR={{ ragflow_history_dir }}
RAGFLOW_LOG_DIR={{ ragflow_log_dir }}

# A user registration switch:
# - Enable registration: 1
# - Disable registration: 0
REGISTER_ENABLED={{ register_enabled }}
# Admin bootstrap credentials
RAGFLOW_ADMIN_EMAIL={{ ragflow_admin_email }}
RAGFLOW_ADMIN_PASSWORD={{ ragflow_admin_password }}

# ───────── Tailscale ────────────────────────────────────────────────
TS_AUTHKEY={{ ts_authkey | default('') }}
DOCKER_BRIDGE_SUBNET={{ docker_bridge_subnet | default('172.20.0.0/16') }}

# ───────── smtp relay ─────────────────────────────────────────────────
SMTP_IMAGE={{ smtp_image | default('boky/postfix:latest') }}
SMTP_HOST={{ smtp_host | default('smtp') }}
SMTP_PORT={{ smtp_port | default(25) }}
SMTP_SSL={{ smtp_ssl | default(false) | lower }}